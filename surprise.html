<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Final Surprise!</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: black;
        }
        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            padding: 1rem;
            background: rgba(0,0,0,0.15);
            backdrop-filter: blur(5px);
            z-index: 100;
        }
        .navbar a {
            color: #fff;
            text-decoration: none;
            font-weight: 600;
            font-size: 1rem;
            opacity: 0.8;
            transition: opacity 0.3s;
        }
        .navbar a:hover, .navbar a.active {
            opacity: 1;
        }
        canvas {
            display: block;
        }
        .center-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(1.5rem, 5vw, 3rem);
            font-weight: bold;
            text-align: center;
            color: gold;
            text-shadow: 0 0 10px gold, 0 0 20px orange, 0 0 30px red;
            animation: glow 1.5s ease-in-out infinite alternate;
            z-index: 10;
        }
        @keyframes glow {
            from {
                text-shadow: 0 0 10px #fff, 0 0 20px #ffc, 0 0 30px #ffc;
            }
            to {
                text-shadow: 0 0 20px #fff, 0 0 30px #ffc, 0 0 40px #ffc;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <a href="index.html">Home</a>
        <a href="gallery.html">Gallery</a>
        
        <a href="games.html">Celebration</a>
        <a href="surprise.html" class="active">Surprise</a>
    </nav>

    <div class="center-message" id="centerMessage">
        ðŸŽ‰ Happy Birthday<br>Shruti Tiwari ðŸŽ‰
    </div>

    <canvas id="fireworksCanvas"></canvas>

    <script>
        const canvas = document.getElementById('fireworksCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // **Using only one sound file path**
        const fireworkSfxPath = 'assets/music/fireworks-379667.mp3';

        let particles = [];
        let rockets = [];

        function random(min, max) {
            return Math.random() * (max - min) + min;
        }

        function createRocket() {
            const startX = random(100, canvas.width - 100);
            const startY = canvas.height;
            const targetY = random(canvas.height * 0.2, canvas.height * 0.5);
            const color = `hsl(${Math.random() * 360}, 100%, 70%)`;

            rockets.push({
                x: startX,
                y: startY,
                targetY: targetY,
                speed: random(4, 6),
                color: color,
            });
            
            // **Play the single sound on launch**
            const fireworkAudio = new Audio(fireworkSfxPath);
            fireworkAudio.play().catch(e => console.error("Sound could not be played:", e));
        }

        function updateRockets() {
            for (let i = rockets.length - 1; i >= 0; i--) {
                const rocket = rockets[i];
                rocket.y -= rocket.speed;

                if (rocket.y <= rocket.targetY) {
                    createExplosion(rocket.x, rocket.y, rocket.color);
                    rockets.splice(i, 1);
                    // **Burst sound is no longer played here**
                }
            }
        }

        function drawRockets() {
            rockets.forEach(rocket => {
                ctx.fillStyle = rocket.color;
                ctx.beginPath();
                ctx.arc(rocket.x, rocket.y, 2, 0, Math.PI * 2);
                ctx.fill();
            });
        }

        function createExplosion(x, y, color) {
            const particleCount = 100;
            for (let i = 0; i < particleCount; i++) {
                particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 8,
                    vy: (Math.random() - 0.5) * 8,
                    alpha: 1,
                    color: color,
                    gravity: 0.1,
                    fade: 0.02
                });
            }
        }

        function updateParticles() {
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.vy += p.gravity;
                p.alpha -= p.fade;

                if (p.alpha <= 0) {
                    particles.splice(i, 1);
                }
            }
        }

        function drawParticles() {
            particles.forEach(p => {
                ctx.globalAlpha = p.alpha;
                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.globalAlpha = 1;
        }

        function fireworksLoop() {
            ctx.fillStyle = "rgba(0, 0, 0, 0.1)";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            if (Math.random() < 0.04) {
                createRocket();
            }

            updateRockets();
            drawRockets();
            updateParticles();
            drawParticles();

            requestAnimationFrame(fireworksLoop);
        }

        setTimeout(() => {
            document.getElementById('centerMessage').style.display = 'none';
            fireworksLoop();
        }, 4000);

        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>